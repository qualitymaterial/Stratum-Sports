# Environment
APP_ENV=production
APP_NAME=Stratum Sports API
APP_HOST=0.0.0.0
APP_PORT=8000
LOG_LEVEL=INFO

# CORS (comma-separated)
CORS_ORIGINS=https://app.stratumsports.com,http://134.209.125.6,http://134.209.125.6:3000

# Auth
# Generate with: python3 -c "import secrets; print(secrets.token_urlsafe(32))"
JWT_SECRET=REPLACE_WITH_STRONG_SECRET
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=720
PASSWORD_RESET_TOKEN_EXPIRE_MINUTES=30

# PostgreSQL
POSTGRES_USER=stratum_prod
POSTGRES_PASSWORD=REPLACE_WITH_STRONG_DB_PASSWORD
POSTGRES_DB=stratum_sports
POSTGRES_HOST=db
POSTGRES_PORT=5432
# Preferred: set POSTGRES_* and let backend construct DATABASE_URL automatically.
# Optional advanced override only:
# DATABASE_URL=postgresql+asyncpg://stratum_prod:urlencoded_password@db:5432/stratum_sports

# Redis
REDIS_URL=redis://redis:6379/0

# Odds API
ODDS_API_KEY=REPLACE_WITH_THE_ODDS_API_KEY
ODDS_API_BASE_URL=https://api.the-odds-api.com/v4
ODDS_POLL_INTERVAL_SECONDS=60
POLL_INTERVAL_SECONDS=
ODDS_POLL_INTERVAL_IDLE_SECONDS=300
ODDS_POLL_INTERVAL_LOW_CREDIT_SECONDS=900
ODDS_API_LOW_CREDIT_THRESHOLD=200
ODDS_API_TARGET_DAILY_CREDITS=1200
ODDS_API_SPORT_KEYS=basketball_nba,basketball_ncaab,americanfootball_nfl
ODDS_API_REGIONS=us
ODDS_API_MARKETS=spreads,totals,h2h
ODDS_API_BOOKMAKERS=
ODDS_API_RETRY_ATTEMPTS=3
ODDS_API_RETRY_BACKOFF_SECONDS=1.0
ODDS_API_RETRY_BACKOFF_MAX_SECONDS=8.0
ODDS_API_CIRCUIT_FAILURES_TO_OPEN=3
ODDS_API_CIRCUIT_OPEN_SECONDS=120
STRATUM_CLOSE_CAPTURE_ENABLED=true
STRATUM_CLOSE_CAPTURE_MAX_EVENTS_PER_CYCLE=10
NBA_KEY_NUMBERS=2,3,4,5,6,7,8,10

# Optional live injury feed (SportsDataIO)
INJURY_FEED_PROVIDER=heuristic
SPORTSDATAIO_API_KEY=
SPORTSDATAIO_BASE_URL=https://api.sportsdata.io/v3
# Set these endpoints based on your SportsDataIO plan (leave blank to use heuristic fallback)
SPORTSDATAIO_INJURIES_ENDPOINT_NBA=
SPORTSDATAIO_INJURIES_ENDPOINT_NCAAB=
SPORTSDATAIO_INJURIES_ENDPOINT_NFL=
# Required only when NFL endpoint includes /{season}/{week} templates
SPORTSDATAIO_NFL_INJURIES_SEASON=
SPORTSDATAIO_NFL_INJURIES_WEEK=
SPORTSDATAIO_TIMEOUT_SECONDS=8.0
SPORTSDATAIO_CACHE_SECONDS=180

# Data retention / gating
SNAPSHOT_RETENTION_HOURS=168
SIGNAL_RETENTION_DAYS=90
CONSENSUS_RETENTION_DAYS=14
CLV_RETENTION_DAYS=60
KPI_RETENTION_DAYS=30
FREE_DELAY_MINUTES=10
FREE_WATCHLIST_LIMIT=3

# Consensus snapshots (derived from stored odds_snapshots; no extra API calls)
CONSENSUS_ENABLED=true
CONSENSUS_LOOKBACK_MINUTES=10
CONSENSUS_MIN_BOOKS=2
CONSENSUS_MIN_MARKETS=1
CONSENSUS_MARKETS=spreads,totals,h2h

# Dislocation signal engine (derived from persisted consensus + odds snapshots)
DISLOCATION_ENABLED=true
DISLOCATION_LOOKBACK_MINUTES=10
DISLOCATION_MIN_BOOKS=5
DISLOCATION_SPREAD_LINE_DELTA=1.0
DISLOCATION_TOTAL_LINE_DELTA=2.0
DISLOCATION_ML_IMPLIED_PROB_DELTA=0.03
DISLOCATION_COOLDOWN_SECONDS=900
DISLOCATION_MAX_SIGNALS_PER_EVENT=6

# Steam v2 signal engine (fast synchronized moves across books)
STEAM_ENABLED=true
STEAM_WINDOW_MINUTES=3
STEAM_MIN_BOOKS=4
STEAM_MIN_MOVE_SPREAD=0.5
STEAM_MIN_MOVE_TOTAL=1.0
STEAM_COOLDOWN_SECONDS=900
STEAM_MAX_SIGNALS_PER_EVENT=4
STEAM_DISCORD_ENABLED=false

# CLV tracking (derived from games + persisted consensus + signals)
CLV_ENABLED=true
CLV_MINUTES_AFTER_COMMENCE=10
CLV_LOOKBACK_DAYS=7
CLV_JOB_INTERVAL_MINUTES=60

# Performance intel surfaces (CLV + signal quality + actionable books)
PERFORMANCE_UI_ENABLED=true
ACTIONABLE_BOOK_CARD_ENABLED=true
PERFORMANCE_DEFAULT_DAYS=30
PERFORMANCE_MAX_LIMIT=200
SIGNAL_FILTER_DEFAULT_MIN_STRENGTH=60
ACTIONABLE_BOOK_MAX_BOOKS=8
FREE_TEASER_ENABLED=true

# Cycle KPI persistence (internal observability)
KPI_ENABLED=true
KPI_WRITE_FAILURES_SOFT=true
OPS_INTERNAL_TOKEN=REPLACE_WITH_LONG_RANDOM_INTERNAL_TOKEN

# Internal weekly ops digest (Discord webhook)
OPS_DIGEST_ENABLED=false
OPS_DIGEST_WEBHOOK_URL=
OPS_DIGEST_WEEKDAY=1
OPS_DIGEST_HOUR_UTC=13
OPS_DIGEST_MINUTE_UTC=0
OPS_DIGEST_LOOKBACK_DAYS=7

# Monitoring
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.1

# Stripe
STRIPE_SECRET_KEY=REPLACE_WITH_STRIPE_SECRET
STRIPE_WEBHOOK_SECRET=REPLACE_WITH_STRIPE_WEBHOOK_SECRET
STRIPE_PRO_PRICE_ID=price_REPLACE
STRIPE_SUCCESS_URL=https://app.stratumsports.com/app/dashboard?billing=success
STRIPE_CANCEL_URL=https://app.stratumsports.com/app/dashboard?billing=cancel

# Frontend
NEXT_PUBLIC_API_BASE_URL=/api/v1
NEXT_PUBLIC_STRIPE_PRO_PRICE_USD=29

# Discord
DISCORD_WEBHOOK_ALLOWED_HOSTS=discord.com,ptb.discord.com,canary.discord.com
