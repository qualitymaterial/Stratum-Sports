# Backend
APP_ENV=development
APP_NAME=Stratum Sports API
APP_HOST=0.0.0.0
APP_PORT=8000
LOG_LEVEL=INFO
CORS_ORIGINS=http://localhost:3000
JWT_SECRET=change-me-in-production
JWT_ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=1440
PASSWORD_RESET_TOKEN_EXPIRE_MINUTES=30

POSTGRES_USER=stratum
POSTGRES_PASSWORD=stratum
POSTGRES_DB=stratum_sports
POSTGRES_HOST=db
POSTGRES_PORT=5432
POSTGRES_HOST_PORT=5433
DATABASE_URL=postgresql+asyncpg://stratum:stratum@db:5432/stratum_sports

REDIS_URL=redis://redis:6379/0

# Odds API
ODDS_API_KEY=
ODDS_API_BASE_URL=https://api.the-odds-api.com/v4
ODDS_POLL_INTERVAL_SECONDS=60
POLL_INTERVAL_SECONDS=
ODDS_POLL_INTERVAL_IDLE_SECONDS=300
ODDS_POLL_INTERVAL_LOW_CREDIT_SECONDS=900
ODDS_API_LOW_CREDIT_THRESHOLD=200
ODDS_API_TARGET_DAILY_CREDITS=1200
ODDS_API_SPORT_KEYS=basketball_nba,basketball_ncaab,americanfootball_nfl
ODDS_API_REGIONS=us
ODDS_API_MARKETS=spreads,totals,h2h
# Optional: limit books to reduce request cost (comma-separated keys)
ODDS_API_BOOKMAKERS=
ODDS_API_RETRY_ATTEMPTS=3
ODDS_API_RETRY_BACKOFF_SECONDS=1.0
ODDS_API_RETRY_BACKOFF_MAX_SECONDS=8.0
ODDS_API_CIRCUIT_FAILURES_TO_OPEN=3
ODDS_API_CIRCUIT_OPEN_SECONDS=120
STRATUM_CLOSE_CAPTURE_ENABLED=true
STRATUM_CLOSE_CAPTURE_MAX_EVENTS_PER_CYCLE=10
NBA_KEY_NUMBERS=2,3,4,5,6,7,8,10

# Optional live injury feed (SportsDataIO)
INJURY_FEED_PROVIDER=heuristic
SPORTSDATAIO_API_KEY=
SPORTSDATAIO_BASE_URL=https://api.sportsdata.io/v3
# Set these endpoints based on your SportsDataIO plan (leave blank to use heuristic fallback)
SPORTSDATAIO_INJURIES_ENDPOINT_NBA=
SPORTSDATAIO_INJURIES_ENDPOINT_NCAAB=
SPORTSDATAIO_INJURIES_ENDPOINT_NFL=
# Required only when NFL endpoint includes /{season}/{week} templates
SPORTSDATAIO_NFL_INJURIES_SEASON=
SPORTSDATAIO_NFL_INJURIES_WEEK=
SPORTSDATAIO_TIMEOUT_SECONDS=8.0
SPORTSDATAIO_CACHE_SECONDS=180

# Retention (optional overrides)
SNAPSHOT_RETENTION_HOURS=48
SIGNAL_RETENTION_DAYS=30
CONSENSUS_RETENTION_DAYS=14
CLV_RETENTION_DAYS=60
KPI_RETENTION_DAYS=30

# Consensus snapshots (derived from stored odds_snapshots; no extra API calls)
CONSENSUS_ENABLED=true
CONSENSUS_LOOKBACK_MINUTES=10
CONSENSUS_MIN_BOOKS=2
CONSENSUS_MIN_MARKETS=1
CONSENSUS_MARKETS=spreads,totals,h2h

# Dislocation signal engine (derived from persisted consensus + odds snapshots)
DISLOCATION_ENABLED=true
DISLOCATION_LOOKBACK_MINUTES=10
DISLOCATION_MIN_BOOKS=5
DISLOCATION_SPREAD_LINE_DELTA=1.0
DISLOCATION_TOTAL_LINE_DELTA=2.0
DISLOCATION_ML_IMPLIED_PROB_DELTA=0.03
DISLOCATION_COOLDOWN_SECONDS=900
DISLOCATION_MAX_SIGNALS_PER_EVENT=6

# Steam v2 signal engine (fast synchronized moves across books)
STEAM_ENABLED=true
STEAM_WINDOW_MINUTES=3
STEAM_MIN_BOOKS=4
STEAM_MIN_MOVE_SPREAD=0.5
STEAM_MIN_MOVE_TOTAL=1.0
STEAM_COOLDOWN_SECONDS=900
STEAM_MAX_SIGNALS_PER_EVENT=4
STEAM_DISCORD_ENABLED=false

# CLV tracking (derived from games + persisted consensus + signals)
CLV_ENABLED=true
CLV_MINUTES_AFTER_COMMENCE=10
CLV_LOOKBACK_DAYS=7
CLV_JOB_INTERVAL_MINUTES=60

# Performance intel surfaces (CLV + signal quality + actionable books)
PERFORMANCE_UI_ENABLED=true
ACTIONABLE_BOOK_CARD_ENABLED=true
PERFORMANCE_DEFAULT_DAYS=30
PERFORMANCE_MAX_LIMIT=200
SIGNAL_FILTER_DEFAULT_MIN_STRENGTH=60
ACTIONABLE_BOOK_MAX_BOOKS=8
FREE_TEASER_ENABLED=true
CONTEXT_SCORE_BLEND_ENABLED=false
CONTEXT_SCORE_BLEND_WEIGHT_OPPORTUNITY=0.8
CONTEXT_SCORE_BLEND_WEIGHT_CONTEXT=0.2
CONTEXT_SCORE_WEIGHT_INJURIES=0.5
CONTEXT_SCORE_WEIGHT_PLAYER_PROPS=0.3
CONTEXT_SCORE_WEIGHT_PACE=0.2

# Cycle KPI persistence (internal observability)
KPI_ENABLED=true
KPI_WRITE_FAILURES_SOFT=true
OPS_INTERNAL_TOKEN=dev-ops-token

# Internal weekly ops digest (Discord webhook)
OPS_DIGEST_ENABLED=false
OPS_DIGEST_WEBHOOK_URL=
OPS_DIGEST_WEEKDAY=1
OPS_DIGEST_HOUR_UTC=13
OPS_DIGEST_MINUTE_UTC=0
OPS_DIGEST_LOOKBACK_DAYS=7

# Free-tier gating (optional overrides)
FREE_DELAY_MINUTES=10
FREE_WATCHLIST_LIMIT=3

# Monitoring
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.1

# Stripe
STRIPE_SECRET_KEY=
STRIPE_WEBHOOK_SECRET=
STRIPE_PRO_PRICE_ID=price_pro_placeholder
STRIPE_SUCCESS_URL=http://localhost:3000/app/dashboard?billing=success
STRIPE_CANCEL_URL=http://localhost:3000/app/dashboard?billing=cancel

# Frontend
NEXT_PUBLIC_API_BASE_URL=http://localhost:8000/api/v1
NEXT_PUBLIC_LANDING_V1_ENABLED=true
NEXT_PUBLIC_STRIPE_PRO_PRICE_USD=29

# Discord
DISCORD_CLIENT_ID=
DISCORD_CLIENT_SECRET=
DISCORD_REDIRECT_URI=http://localhost:3000/auth/discord/callback
DISCORD_WEBHOOK_ALLOWED_HOSTS=discord.com,ptb.discord.com,canary.discord.com
